\section{计算几何}

\subsection{基础模板}
\lstinputlisting{数学知识/计算几何/geometry.cpp}

\subsection{极角序}

直接计算极角, \verb|atan2(y,x)|函数可直接计算\verb|(x,y)|的极角, 值域是$(-\pi,\pi]$。注意第四象限的极角比第一象限要小。
\lstinputlisting{数学知识/计算几何/极角序/psort1.cpp}

先比较象限再做叉乘
\lstinputlisting{数学知识/计算几何/极角序/psort2.cpp}
这种方法常数可能稍微大一点，但是精度比较好，如果坐标都是整数的话是完全没有精度损失的。

\subsection{凸包}

\textbf{Graham扫描法}


最左下角的一个点，一定在凸包上，以这个角为极点，进行极角排序，然后逐个点扫描。用栈来维护，如果栈中点数小于3，就直接进栈；否则，检查栈顶三个点组成的两个向量的旋转方向是否为逆时针（这可以用叉乘判断），若是则进栈，若不是则弹出栈顶，直到栈中点数小于3或者满足逆时针条件为止。

实现时需要注意，要对极角排序的极点特殊处理，使它始终排在第一位。
\lstinputlisting{数学知识/计算几何/Andrew.cpp}

\textbf{Andrew算法}


另一种方法是不做极角排序，直接以横坐标为第一关键词、纵坐标为第二关键词排序，这样将顶点依次相连（不首尾相连）的话，也能保证不交叉。

然后同上一种方法类似，正反遍历两遍，分别求出上下凸包结合起来就好。
\lstinputlisting{数学知识/计算几何/Graham.cpp}
这种方法一般会比第一种快一点。