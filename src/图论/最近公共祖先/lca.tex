\section{最近公共祖先(LCA)}
\subsection{向上标记法}
向上标价法最差的复杂度是$O(N)$的，适用于求 LCA 次数少的情况，代码非常好写
\lstinputlisting{图论/最近公共祖先/向上标记法.cpp}
\subsection{倍增 LCA}
值得注意的是向上倍增的过程中\verb|for( int i = t ; i >= 0 ; i --)| 不能写错
\lstinputlisting{图论/最近公共祖先/倍增LCA.cpp}
%\subsection{Tarjan LCA}
\subsection{RMQ 求 LCA}
dfs 求出深度和dfn。位置在$[dfn_{u+1},dfn_{v}]$之间深度最小的节点的父亲就是LCA。区间最值用 ST表维护。
\lstinputlisting{图论/最近公共祖先/dfnLCA.cpp}